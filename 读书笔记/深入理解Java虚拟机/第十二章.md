# 第十二章

## Java 线程调度

线程调度是指系统为线程分配处理器使用权的过程，主要调度方式有两种：
* 协同式线程调度，线程的执行时间由线程本身来控制，线程把自己的工作执行完成之后，要主动通知系统切换到另外一个线程上。

* 抢占式线程调度，每个线程由系统来分配执行时间，线程的切换不由线程本身来决定。

## 线程状态转换

Java 定义了 5 种线程状态，在任意一个时间点，一个线程只能有且只有其中的一种状态，这 5 种状态分别如下：

* 新建（new），创建后尚未启动的线程处于这种状态

* 运行（Runnable），Runnble 包括了操作系统线程状态中的 Running 和 Ready，也就是处于此状态的线程有可能正在执行，也有可能正在等待 CPU 为它分配执行时间

* 无期限等待（Waiting），处于这种状态的线程不会被分配 CPU 执行时间，它们要等待被其他线程显式地唤醒。以下方法会让线程陷入无期限的等待状态：

  * 没有设置 Timeout 参数的 Object.wait() 方法
  * 没有设置 Timeout 参数的 Thread.join() 方法
  * LockSupport.park() 方法

* 期限等待（Timed Waiting），处于这种状态的线程也不会被分配 CPU 执行时间，不过无须等待被其他线程显式地唤醒，在一定时间之后它们就会由系统自动唤醒。以下方法会让线程进入期限等待状态：
  * Thread.sleep();
  * 设置了 Timeout 参数的 Object.wait() 方法
  * 设置了 Timeout 参数的 Thread.join() 方法
  * LockSupport.parkNanos() 方法
  * LockSupport.parkUnil() 方法


* 阻塞（Blocked），线程被阻塞了，“阻塞状态”与“等待状态”的区别是“阻塞状态”在等待着获取一个排他锁，这个事件将在另外一个线程放弃这个锁的时候发生；而“等待状态”则是在等待一段时间，或者唤醒动作的发生。在程序等待进入同步区域的时候，线程将进入这种状态。

* 结束（Terminated），以终止线程的线程状态，线程已经结束执行。
